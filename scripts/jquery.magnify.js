"use strict";!function(C){C.fn.magnify=function(W){W=C.extend({src:"",speed:100,timeout:-1,touchBottomOffset:0,finalWidth:null,finalHeight:null,magnifiedWidth:null,magnifiedHeight:null,limitBounds:!1,mobileCloseEvent:"touchstart",afterLoad:function(){}},W);var t=this,x=C("html"),i=0,M=function(){clearTimeout(i),i=setTimeout(function(){t.destroy(),t.magnify(W)},100)};return this.destroy=function(){return this.each(function(){var t=C(this),i=t.prev("div.magnify-lens"),e=t.data("originalStyle");t.parent("div.magnify").length&&i.length&&(e?t.attr("style",e):t.removeAttr("style"),t.unwrap(),i.remove())}),C(window).off("resize",M),t},C(window).resize(M),this.each(function(){!function(t){var s=C(t),i=s.closest("a"),n={};for(var e in W)n[e]=s.attr("data-magnify-"+e.toLowerCase());var a=n.src||W.src||i.attr("href")||"";if(a){var o,r,f,l,d,c,u,h,g,m,p,v,y,b,w=0,N=0,B=function(){var t=o.offset();return b={top:s.offset().top-t.top+parseInt(s.css("border-top-width"))+parseInt(s.css("padding-top")),left:s.offset().left-t.left+parseInt(s.css("border-left-width"))+parseInt(s.css("padding-left"))},t.top+=b.top,t.left+=b.left,t},k=function(){r.is(":visible")&&r.fadeOut(W.speed,function(){x.removeClass("magnifying").trigger("magnifyend")})},E=function(t){if(l){if(t?(t.preventDefault(),g=t.pageX||t.originalEvent.touches[0].pageX,m=t.pageY||t.originalEvent.touches[0].pageY,s.data("lastPos",{x:g,y:m})):(g=s.data("lastPos").x,m=s.data("lastPos").y),p=g-y.left,v=m-y.top-W.touchBottomOffset,r.is(":animated")||(w<p&&p<f-w&&N<v&&v<l-N?r.is(":hidden")&&(x.addClass("magnifying").trigger("magnifystart"),r.fadeIn(W.speed)):k()),r.is(":visible")){var i="";if(d&&c){var e=-Math.round(p/f*d-u/2),n=-Math.round(v/l*c-h/2);if(W.limitBounds){var a=-Math.round((f-w)/f*d-u/2),o=-Math.round((l-N)/l*c-h/2);0<e?e=0:e<a&&(e=a),0<n?n=0:n<o&&(n=o)}i=e+"px "+n+"px"}r.css({top:Math.round(v-h/2)+b.top+"px",left:Math.round(p-u/2)+b.left+"px","background-position":i})}}else M()};isNaN(+n.speed)||(W.speed=+n.speed),isNaN(+n.timeout)||(W.timeout=+n.timeout),isNaN(+n.finalWidth)||(W.finalWidth=+n.finalWidth),isNaN(+n.finalHeight)||(W.finalHeight=+n.finalHeight),isNaN(+n.magnifiedWidth)||(W.magnifiedWidth=+n.magnifiedWidth),isNaN(+n.magnifiedHeight)||(W.magnifiedHeight=+n.magnifiedHeight),"true"===n.limitBounds&&(W.limitBounds=!0),"function"==typeof window[n.afterLoad]&&(W.afterLoad=window[n.afterLoad]),/\b(Android|BlackBerry|IEMobile|iPad|iPhone|Mobile|Opera Mini)\b/.test(navigator.userAgent)?isNaN(+n.touchBottomOffset)||(W.touchBottomOffset=+n.touchBottomOffset):W.touchBottomOffset=0,s.data("originalStyle",s.attr("style"));var H=new Image;C(H).on({load:function(){s.css("display","block"),s.parent(".magnify").length||s.wrap('<div class="magnify"></div>'),o=s.parent(".magnify"),s.prev(".magnify-lens").length?o.children(".magnify-lens").css("background-image","url('"+a+"')"):s.before('<div class="magnify-lens loading" style="background:url(\''+a+"') 0 0 no-repeat\"></div>"),(r=o.children(".magnify-lens")).removeClass("loading"),f=W.finalWidth||s.width(),l=W.finalHeight||s.height(),d=W.magnifiedWidth||H.width,c=W.magnifiedHeight||H.height,u=r.width(),h=r.height(),y=B(),W.limitBounds&&(w=u/2/(d/f),N=h/2/(c/l)),d===H.width&&c===H.height||r.css("background-size",d+"px "+c+"px"),s.data("zoomSize",{width:d,height:c}),o.data("mobileCloseEvent",n.mobileCloseEvent||W.mobileCloseEvent),H=null,W.afterLoad(),r.is(":visible")&&E(),o.off().on({"mousemove touchmove":E,mouseenter:function(){y=B()},mouseleave:k}),0<=W.timeout&&o.on("touchend",function(){setTimeout(k,W.timeout)}),C("body").not(o).on("touchstart",k);var t=s.attr("usemap");if(t){var e=C("map[name="+t.slice(1)+"]");s.after(e),o.click(function(t){if(t.clientX||t.clientY){r.hide();var i=document.elementFromPoint(t.clientX||t.originalEvent.touches[0].clientX,t.clientY||t.originalEvent.touches[0].clientY);"AREA"===i.nodeName?i.click():C("area",e).each(function(){var t=C(this).attr("coords").split(",");if(p>=t[0]&&p<=t[2]&&v>=t[1]&&v<=t[3])return this.click(),!1})}})}i.length&&(i.css("display","inline-block"),!i.attr("href")||n.src||W.src||i.click(function(t){t.preventDefault()}))},error:function(){H=null}}),H.src=a}}(this)})}}(jQuery);